which(E==8)
which(E>8)
E[which(E>8)]
trueMean1<-5
trueSD1<-5
population1<-rnorm(1e6,trueMean1,trueSD1)
trueMean2<-4
trueSD2<-5
population2<-rnorm(1e6,trueMean2,trueSD2)
Size<-50
Sample1<-sample(population1,Size)
Sample2<-sample(popualtion2,Size)
Sample2<-sample(population2,Size)
boxplot(Sample1,Sample2)
individual<-c("B","A")
individual1<-c("B","A")
individual2<-c("A","A")
Gam1<-sample(individual1,1)
Gam2<-sample(individual2,1)
newBaby<-c(Gam1,Gam2)
head(newBaby)
isHet<-c()
for(i in 1:100){Gam1<-sample(individual1,1)Gam2<-sample(individual2,1)newBaby<-c(Gam1,Gam2)isHet[i]<-Gam1==Gam2}
for(i in 1:100) {Gam1<-sample(individual1,1)Gam2<-sample(individual2,1)newBaby<-c(Gam1,Gam2)isHet[i]<-Gam1==Gam2}
for (i in 1:100) {Gam1<-sample(individual1,1)Gam2<-sample(individual2,1)newBaby<-c(Gam1,Gam2)isHet[i]<-Gam1==Gam2}
for(i in 1:100){Gam1<-sample(individual1,1)Gam2<-sample(individual2,1)newBaby<-c(Gam1,Gam2)isHet[i]<-Gam1==Gam2}
install.packages(c("adegenet", "poppr", "dplyr", "hierfstat", "reshape2", "ggplot2", "RColorBrewer", "scales"))
library(adegenet)
data1<-read.csv("C:\Users\13048\Documents\Evolution Notepad ++\Data predation indices1.xlsx")
data1<-read.csv("C:U\Users\13048\Documents\Evolution Notepad ++\Data predation indices1.xlsx")
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
library(phytools)
trees<-list()
births<-c()
Fractions<-c()
for(i in 1:100)
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
library(phytools)
trees<-list()
births<-c()
Fractions<-c()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,lambda=births[i],mu=births[i]*Fractions)
}
div_rate<- sapply(trees,function(x)x$lambda-x$mu)
log_tips<-log(sapply(trees,function(x)length(x$tip.label)))
library(ggplot2)
ggplot(data=data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+xlab=("Log number of tips")+ylab=("Net diversification rate")+
ggtitle("Net diversification vs Log number of tips")
ggplot(data=data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
xlab=("Log number of tips")+
ylab=("Net diversification rate")+
ggtitle("Net diversification vs Log number of tips")
ggplot(data=data.frame(div_rate,log_tips))
ggplot(data=0:100(div_rate,log_tips))
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
library(phytools)
trees<-list()
births<-vector()
Fractions<-vector()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,lambda=births[i],mu=births[i]*Fractions)
}
div_rate<- sapply(trees,function(x)x$lambda-x$mu)
log_tips<-log(sapply(trees,function(x)length(x$tip.label)))
library(ggplot2)
ggplot(data=data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
xlab=("Log number of tips")+
ylab=("Net diversification rate")+
ggtitle("Net diversification vs Log number of tips")
ggplot(data=trees(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
xlab=("Log number of tips")+
ylab=("Net diversification rate")+
ggtitle("Net diversification vs Log number of tips")
summary(trees)
head(trees)
r(trees)
install.packages("geiger")
library(geiger)
bd.ms(phy=trees,n=100)
bd.ms(phy=NULL,n=100)
bd.ms(phy=NULL,time=0,n=100,missing=0,crown=TRUE,epsilon = 0)
library(ggplot2)
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
library(phytools)
trees<-list()
births<-vector()
Fractions<-vector()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,lambda=births[i],mu=births[i]*Fractions)
}
div_rate<- sapply(trees,function(x)x$lambda-x$mu)
log_tips<-log(sapply(trees,function(x)length(x$tip.label)))
library(ggplot2)
ggplot(data=data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
xlab("Log number of tips")+
ylab("Net diversification rate")+
ggtitle("Net diversification vs log number of tips")
traitMat<-cbind(traits[[1]],traits[[4]])
head(div_rate)
log_tips
plot(trees)
trees
head(trees)
phylogram.plot(trees)
phylogram.plot(trees,Ntip = 1:100)
phylogram.plot(trees,Ntip = 1:100,Nnode=1:100)
phylogram.plot(trees,Ntip = 1:100,Nnode=1:100,type="phylogram")
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
library(phytools)
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
#Questions 1 through 3
library(phytools)
trees<-list()
births<-vector()
Fractions<-vector()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,lambda=births[i],mu=births[i]*Fractions)
}
plot(trees[[i]])
#Question 7
?`phytools-package`
#Question 4
div_rate<- sapply(trees,function(x)x$lambda-x$mu)
log_tips<-log(sapply(trees,function(x)length(x$tip.label)))
library(ggplot2)
ggplot(data=data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
xlab("Log number of tips")+
ylab("Net diversification rate")+
ggtitle("Net diversification vs log number of tips")
length(div_rate)
length(log_tips)
random<-vector()
random2<-vector()
treelist<-vector()
for (i in 100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<-(Fractions[i])
treelist[[i]]<-mean(trees[[i]]$edge.length)
}
plot(trees[[i]])
#Question 4
div_rate<-sapply(trees,function(x) length(x$tip.label))
log_tips<-log(sapply(trees,function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
xlab("Log number of tips")+
ylab("Net diversificatiob")+
ggtitle("Net diversification vs Log number of tips")
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
geom_abline()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
geom_line()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
#Question 5
speciationrate<-sapply(births,function(x)x)
#Question 5
speciation_rate<-sapply(births,function(x)x)
avg_branchlength<-sapply(trees,function(x) mean(x$edge.length,na.rm=TRUE))
ggplot(data = data.frame(speciation_rate,avg_branchlength,aes(x=speciation_rate,y=avg_branchlength))+
geom_point()+
xlab("Speciation rate")+
ylab("Average branch length")+
ggtitle("Speciation rate vs. Average branch length"))
ggplot(data = data.frame(speciation_rate,avg_branchlength),aes(x=speciation_rate,y=avg_branchlength))+
geom_point()+
xlab("Speciation rate")+
ylab("Average branch length")+
ggtitle("Speciation rate vs. Average branch length")
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
#Questions 1 through 3
library(phytools)
trees<-list()
births<-vector()
Fractions<-vector()
random<-vector()
random2<-vector()
treelist<-vector()
for (i in 100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<-(Fractions[i])
treelist[[i]]<-mean(trees[[i]]$edge.length)
}
plot(trees[[i]])
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
#Questions 1 through 3
library(phytools)
trees<-list()
births<-vector()
Fractions<-vector()
random<-vector()
random2<-vector()
treelist<-vector()
for (i in 100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<-(Fractions[i])
treelist[[i]]<-mean(trees[[i]]$edge.length)
}
plot(trees[[i]])
#Question 4
div_rate<-sapply(trees,function(x) length(x$tip.label))
log_tips<-log(sapply(trees,function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
geom_line()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
#Questions 1 through 3
library(phytools)
trees<-list()
births<-vector()
Fractions<-vector()
random<-vector()
random2<-vector()
treelist<-vector()
for (i in 100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<-(Fractions[i])
treelist[[i]]<-mean(trees[[i]]$edge.length)
}
plot(trees[[i]])
#Question 4
div_rate<-sapply(trees,function(x) length(x$tip.label))
log_tips<-log(sapply(trees,function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
geom_line()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
#Questions 1 through 3
library(phytools)
trees<-list()
births<-vector()
Fractions<-vector()
random<-vector()
random2<-vector()
treelist<-vector()
for (i in 100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<-(Fractions[i])
treelist[[i]]<-mean(trees[[i]]$edge.length)
}
plot(trees[[i]])
#Question 4
div_rate<-sapply(trees,function(x) length(x$tip.label))
log_tips<-log(sapply(trees,function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
geom_line()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
geom_path()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
geom_abline()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_line()+
geom_abline()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
geom_line()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
ggplot(data = data.frame(speciation_rate,avg_branchlength),aes(x=speciation_rate,y=avg_branchlength))+
geom_point()+
xlab("Speciation rate")+
ylab("Average branch length")+
ggtitle("Speciation rate vs. Average branch length")
#Question 6
cor(speciation_rate,avg_branchlength)
#Question 7
largest_tree<-trees[[which.max(sapply(trees,length))]]
tree<-largest_tree
plot(tree)
rates<-vector()
#Question 7
largest_tree<-trees[[which.max(sapply(trees,length))]]
Tree<-largest_tree
plot(tree)
rates<-vector()
traits<-list()
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
#Questions 1 through 3
library(phytools)
trees<-list()
births<-vector()
Fractions<-vector()
random<-vector()
random2<-vector()
treelist<-vector()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<-(Fractions[i])
treelist[[i]]<-mean(trees[[i]]$edge.length)
}
plot(trees[[i]])
#Question 4
div_rate<-sapply(trees,function(x) length(x$tip.label))
log_tips<-log(sapply(trees,function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
geom_line()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
#Question 5
speciation_rate<-sapply(births,function(x)x)
avg_branchlength<-sapply(trees,function(x) mean(x$edge.length,na.rm=TRUE))
ggplot(data = data.frame(speciation_rate,avg_branchlength),aes(x=speciation_rate,y=avg_branchlength))+
geom_point()+
xlab("Speciation rate")+
ylab("Average branch length")+
ggtitle("Speciation rate vs. Average branch length")
#Question 6
cor(speciation_rate,avg_branchlength)
#Question 7
largest_tree<-trees[[which.max(sapply(trees,length))]]
Tree<-largest_tree
plot(tree)
rates<-vector()
traits<-list()
for(i in 1:100){
rates[i]<-runif(1)
traits[[i]]<-fastBM(tree=Tree.sig2=rates[i])
for(i in 1:100){
rates[i]<-runif(1)
traits[[i]]<-fastBM(tree=Tree,sig2=rates[i])
}
#Question 8
mean_traits<-sapply(traits,mean)
cor(mean_traits,rates)
plot(rates,mean_traits,xlan="rates",ylab="mean trait")
plot(rates,mean_traits,xlan="rates",ylab="mean trait",title("Rate vs Mean Trait"))
#Question 9
var_traits<-sapply(traits,var)
cor(var_traits,rates)
plot(rates,var_traits,xlab="rates",ylab="variation of traits")
plot(rates,var_traits,xlab="rates",ylab="variation of traits",title("Rate vs Variation of Traits"))
#Question 10
cor(traits[[1]],traits[[2]])
traitMat<-cbind(traits[[1]],traits[[4]])
plot(traitMat)
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
#Questions 1 through 3
library(phytools)
trees<-list()
births<-vector()
Fractions<-vector()
random<-vector()
random2<-vector()
treelist<-vector()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<-(Fractions[i])
treelist[[i]]<-mean(trees[[i]]$edge.length)
}
plot(trees[[i]])
#Question 4
div_rate<-sapply(trees,function(x) length(x$tip.label))
log_tips<-log(sapply(trees,function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
geom_line()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
#Question 5
speciation_rate<-sapply(births,function(x)x)
avg_branchlength<-sapply(trees,function(x) mean(x$edge.length,na.rm=TRUE))
ggplot(data = data.frame(speciation_rate,avg_branchlength),aes(x=speciation_rate,y=avg_branchlength))+
geom_point()+
xlab("Speciation rate")+
ylab("Average branch length")+
ggtitle("Speciation rate vs. Average branch length")
#Question 6
cor(speciation_rate,avg_branchlength)
#Question 6
cor(speciation_rate,avg_branchlength)
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_08')
#Questions 1 through 3
library(phytools)
trees<-list()
births<-vector()
Fractions<-vector()
random<-vector()
random2<-vector()
treelist<-vector()
for (i in 1:100){
births[i]<-runif(1)
Fractions[i]<-runif(1)
trees[[i]]<-pbtree(n=100,b=births[i],d=births[i]*Fractions[i])
random[[i]]<-births[i]
random2[[i]]<-(Fractions[i])
treelist[[i]]<-mean(trees[[i]]$edge.length)
}
plot(trees[[i]])
#Question 4
div_rate<-sapply(trees,function(x) length(x$tip.label))
log_tips<-log(sapply(trees,function(x) length(x$tip.label)))
library(ggplot2)
ggplot(data = data.frame(div_rate,log_tips),aes(x=log_tips,y=div_rate))+
geom_point()+
geom_line()+
xlab("Log number of tips")+
ylab("Net diversification")+
ggtitle("Net diversification vs Log number of tips")
#Question 5
speciation_rate<-sapply(births,function(x)x)
avg_branchlength<-sapply(trees,function(x) mean(x$edge.length,na.rm=TRUE))
ggplot(data = data.frame(speciation_rate,avg_branchlength),aes(x=speciation_rate,y=avg_branchlength))+
geom_point()+
xlab("Speciation rate")+
ylab("Average branch length")+
ggtitle("Speciation rate vs. Average branch length")
#Question 6
cor(speciation_rate,avg_branchlength)
#Question 7
largest_tree<-trees[[which.max(sapply(trees,length))]]
Tree<-largest_tree
plot(tree)
rates<-vector()
traits<-list()
for(i in 1:100){
rates[i]<-runif(1)
traits[[i]]<-fastBM(tree=Tree,sig2=rates[i])
}
#Question 8
mean_traits<-sapply(traits,mean)
cor(mean_traits,rates)
plot(rates,mean_traits,xlan="rates",ylab="mean trait",title("Rate vs Mean Trait"))
#Question 9
var_traits<-sapply(traits,var)
cor(var_traits,rates)
plot(rates,var_traits,xlab="rates",ylab="variation of traits",title("Rate vs Variation of Traits"))
#Question 10
cor(traits[[1]],traits[[2]])
traitMat<-cbind(traits[[1]],traits[[4]])
plot(traitMat)
#Extra Credit
phylomorphospace(Tree,traitMat,xlab="Trait 1",ylab="Trait 2")
plot(traitMat)
#Extra Credit
phylomorphospace(Tree,traitMat,xlab="Trait 1",ylab="Trait 2")
