file.path("folder1","folder2")
library(swirl)
swirl()
source("~/.active-rstudio-document")
library(swirl)
swirl()
dir.create(file.path("testdir2","testdir3")
file.path(dir.create("testdir2","testdir3")
1
library(swirl)
swirl()
dir.create(file.path(testdir2,testdir3))
dir.create(file.path(testdir2,testdir3)
dir.create(file.path(testdir2,testdir3)
dir.create(file.path(testdir2,testdir3)
dir.create(file.path('testdir2', 'testdir3'), recurssive=TRUE
dir.create(file.path('testdir2', 'testdir3'), recurssive=TRUE
library(swirl)
library(swirl)
swirl()
1:20
pi:10
15:1
`:`
?`:`
seq(1,20)
seq(0, 10, by=0.5)
seq(5, 10, length=30)
my_seq<-seq(5, 10, length=30)
length(my_seq)
1:length(my_seq)
seq(along.with = my_seq)
seq_along(my_seq)
rep(0, times=40)
rep(c(0,1,2)
rep(c(0,1,2), times = 10)
rep(c(0, 1, 2), times = 10)
rep(c(0, 1, 2), each = 10)
dir.create(file.path('testdir2', 'testdir3'), recursive = TRUE
setwd(old.dir)
set('')
setwd('')
setwd(' ')
berenCor<-cor.test
Data1<-read.csv('http://jonsmitchell.com/data/beren.csv',stringsAsFactors=F)
Data2<-read.csv('http://jonsmitchell/data/cyrus.csv',stringsAsFactor=F)
avgFeed<-tapply(beren3$value[Feeds],beren3$age[Feeds],mean)
avgMilk<-mean(beren3$value[Feeds]
avgMilk<-mean(beren3$value[Feeds])
Feeds<-which(beren3$event =="bottle")
beren3<-beren2[order(beren2$age) ,]
Feeds<-which(beren3$event =="bottle")
avgFeed
Mass<-which(Data1[,9]=='bottle')
head(Data1)
head(Data1)
head(Data1)
Mass<-which(Data1[,9]=='trait_mass')
Data1<-read.csv('htpp://jonsmitchell.com/data/beren.csv',stringsAsFactors=F)
Data1<-read.csv('http://jonsmitchell.com/data/beren.csv',stringsAsFactor=F)
Data2<-read.csv('http://jonsmitchell.com/data/cyrus.csv',stringsAsFactor=F)
head(Data1)
Mass<-which(Data1[,9]=='trait_mass')
berenMass<-Data1[Mass,]
head(berenMass)
Mass<-which(Data1[,'event']=='trait_mass')
head(berenMass)
Data1[1:3]
dayID<-apply(Data1,1,function(x)paste(x[1:3],collapse='-'))
dateID<-sapply(dayID,as.Date,format="%Y-%m-%d",origin="2019-04-18")
head(Data1)
Data1$age<-dateID-dateID[which(Data1$event=='birth')]
head(Data1)
head(berenMass)
beren2<-Data1
beren3<-beren2[order(beren2$age),]
Mass<-which(beren3$event=="trait_mass")
avgMass<-mean(beren3$value[Mass])
avgMass
avgMass<-tapply(beren3$value[Mass],beren3$age[Mass],mean)
avgMass
varMass<-tapply(beren3$value[Mass],beren3$age[Mass],var)
totalMass<-tapply(beren3$value[Mass],beren3$age[Mass],sum)
numMass<-tapply(beren3$value[Mass],beren3$age[Mass],length)
cor(beren3$value[Mass],beren3$age[Mass])
cor.test(beren3$value[Mass],beren3$age[Mass])
berenCor<-cor.test(beren3$value[Mass],beren3$age[Mass])
summary(berenCor)
berenANOVA<-aov(beren3$value[Mass]~beren3$age[Mass])
boxplot(beren3$value[Mass]~beren3$age[Mass],xlab="Age (days)",ylab="mass (kg)")
par(las=1,mar=c(5,5,1,1),mgp=c(2,0.5,0),tck=-0.01)
plot(as.numeric(names(totalMass)),totalMass,type="p",ylim=c(0,20),col="red",pch=16,xlab="Age in Days",ylab="Mass in Kg")
points(cyrus3$value[cMass]/1000~cyrus3$age[cMass],type="p",pch=17,col="blue",xlab="Age in Days",ylab="mass in Kg")
title("Beren and Cyrus Age vs Mass",xlab="Age in Days",ylab="Mass in Kg")
legend(1100, 5.5, legend=c("Beren", "Cyrus"),
col=c("red", "blue"), lty=1:1, cex=0.8,
title="Kids", text.font=4, bg="orange")
head(Data2)
cyrus2<-Data2
cyrus3<-cyrus2[order(cyrus2$age),]
write.csv(cyrus3,'cyrus_new.csv',quote=F,row.names=FALSE)
cMass<-which(cyrus3$event=="trait_mass")
avgcMass<-mean(cyrus3$value[cMass])
5
A<-5
A*2
B<-c(A,5,5)
B
B*2
'B'*2
B<-c(A,5,5)
B*2
C<-c(B,6,10)
C*6
D<-c(1,5,10,15,20)
sum(D)
mean(D)
min(D)
E<-c(6,7,8,9,10)
which(E==8)
which(E>8)
E[which(E>8)]
trueMean1<-5
trueSD1<-5
population1<-rnorm(1e6,trueMean1,trueSD1)
trueMean2<-4
trueSD2<-5
population2<-rnorm(1e6,trueMean2,trueSD2)
Size<-50
Sample1<-sample(population1,Size)
Sample2<-sample(popualtion2,Size)
Sample2<-sample(population2,Size)
boxplot(Sample1,Sample2)
individual<-c("B","A")
individual1<-c("B","A")
individual2<-c("A","A")
Gam1<-sample(individual1,1)
Gam2<-sample(individual2,1)
newBaby<-c(Gam1,Gam2)
head(newBaby)
isHet<-c()
for(i in 1:100){Gam1<-sample(individual1,1)Gam2<-sample(individual2,1)newBaby<-c(Gam1,Gam2)isHet[i]<-Gam1==Gam2}
for(i in 1:100) {Gam1<-sample(individual1,1)Gam2<-sample(individual2,1)newBaby<-c(Gam1,Gam2)isHet[i]<-Gam1==Gam2}
for (i in 1:100) {Gam1<-sample(individual1,1)Gam2<-sample(individual2,1)newBaby<-c(Gam1,Gam2)isHet[i]<-Gam1==Gam2}
for(i in 1:100){Gam1<-sample(individual1,1)Gam2<-sample(individual2,1)newBaby<-c(Gam1,Gam2)isHet[i]<-Gam1==Gam2}
setwd('C:\Users\13048\Desktop\Evolution\Tasks\Task_04')
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_04')
source("htpp://jonsmitchell.com/code/fxn05.R")
source("http://jonsmitchell.com/code/fxn05.R")
Pop1<-simPop(Popsize=50,nGenerations=100,initial_p=0.5,h=1,s=0)
plot(1:nrow(Pop1),Pop[,1],ylim=c(0,1),type="1",xlab="generation",ylab="allele freq.",lwd=2)
plot(1:nrow(Pop1),Pop1[,1],ylim=c(0,1),type="1",xlab="generation",ylab="allele freq.",lwd=2)
plot(1:nrow(Pop1),Pop1[,1],ylim=c(0,1),type="l",xlab="generation",ylab="allele freq.",lwd=2)
lines(1:nrow(Pop1),Pop1[,2],lwd=2,col='red')
legend("topleft",legend=c("a","b"),col=c("black","red"),lwd=2,bty="n")
plotFit(nruns=10,n=50,ngens=100,init_p=0.5,h=1,s=0)
Expectation<-c(10,10,10,10)
Observed<-c(15,15,5,5)
Chisq<-sum(((Expectation-Observed)^2)/Expectation)
barplot(rbind(Expectation,Observed),beside=T,main=bquote(chi^2~"="~.(Chisq)),legend.text=c("expected","observed"))
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_04')
source("http://jonsmitchell.com/code/fxn05.R")
Pop1<-simPop(Popsize=50,nGenerations=100,initial_p=0.5,h=1,s=0)
plot(1:nrow(Pop1),Pop1[,1],ylim=c(0,1),type="l",xlab="generation",ylab="allele freq.",lwd=2)
lines(1:nrow(Pop1),Pop1[,2],lwd=2,col='red')
legend("topleft",legend=c("a","b"),col=c("black","red"),lwd=2,bty="n")
plotFit(nruns=10,n=50,ngens=100,init_p=0.5,h=1,s=0)
Expectation<-c(10,10,10,10)
Observed<-c(15,15,5,5)
Chisq<-sum(((Expectation-Observed)^2)/Expectation)
barplot(rbind(Expectation,Observed),beside=T,main=bquote(chi^2~"="~.(Chisq)),legend.text=c("expected","observed"))
results<-read.csv("http://jonsmitchell.com/data/biol112labresults.csv",stringsAsFactors=F)
counts<-results[,c("yellow","red","green","blue","black","tan")]
backgrounds<-c("White","Red","Yellow","Green","Blue","Black")
backgroundCol<-c("white","#d53e4f","#fee08b","#abdda4","#3288bd","black")
calcChi(counts[1,])
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_04')
source("http://jonsmitchell.com/code/fxn05.R")
Pop1<-simPop(Popsize=50,nGenerations=100,initial_p=0.5,h=1,s=0)
plot(1:nrow(Pop1),Pop1[,1],ylim=c(0,1),type="l",xlab="generation",ylab="allele freq.",lwd=2)
lines(1:nrow(Pop1),Pop1[,2],lwd=2,col='red')
legend("topleft",legend=c("a","b"),col=c("black","red"),lwd=2,bty="n")
plotFit(nruns=10,n=50,ngens=100,init_p=0.5,h=1,s=0)
Expectation<-c(10,10,10,10)
Observed<-c(15,15,5,5)
Chisq<-sum(((Expectation-Observed)^2)/Expectation)
barplot(rbind(Expectation,Observed),beside=T,main=bquote(chi^2~"="~.(Chisq)),legend.text=c("expected","observed"))
results<-read.csv("http://jonsmitchell.com/data/biol112labresults.csv",stringsAsFactors=F)
counts<-results[,c("yellow","red","green","blue","black","tan")]
backgrounds<-c("White","Red","Yellow","Green","Blue","Black")
backgroundCol<-c("white","#d53e4f","#fee08b","#abdda4","#3288bd","black")
calcChi(counts[1,])
Chisqs<-apply(counts,1,calcChi)
plotChis(counts)
plotChis(counts)
Avg<-mean(Chisqs)
Avg
backgroundAvgs<-tapply(Chisqs,results[,3],mean)
propSig<-length(which(Chisqs>11.70)/length(Chisqs)
propSig<-length(which(Chisqs>11.70))/length(Chisqs)
propSig<-length(which(Chisqs>11.70))/length(Chisqs)
percSig<-round(100*propSig)
percSig
par(las=1,mar=c(4,4,1,1),mgp=c(2,0.5,0),tck=-0.01,cex.axis=1)
hist(Chisqs,main="",xlab="chi-squared values",ylab="frequency")
par(las=1,mar=c(4,4,1,1),mgp=c(2,0.5,0),tck=-0.01,cex.axis=1)
plot(1,1,xlim=c(0,400),ylim=c(1,8.5),xlab="",ylab="",type="n",yaxt="n")
plot(1,1,xlim=c(0,400),ylim=c(1,8.5),xlab="",ylab="",type="n",yaxt="n")
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_04')
source("http://jonsmitchell.com/code/fxn05.R")
Pop1<-simPop(Popsize=50,nGenerations=100,initial_p=0.5,h=1,s=0)
plot(1:nrow(Pop1),Pop1[,1],ylim=c(0,1),type="l",xlab="generation",ylab="allele freq.",lwd=2)
lines(1:nrow(Pop1),Pop1[,2],lwd=2,col='red')
legend("topleft",legend=c("a","b"),col=c("black","red"),lwd=2,bty="n")
plotFit(nruns=10,n=50,ngens=100,init_p=0.5,h=1,s=0)
Observed<-c(15,15,5,5)
Chisq<-sum(((Expectation-Observed)^2)/Expectation)
barplot(rbind(Expectation,Observed),beside=T,main=bquote(chi^2~"="~.(Chisq)),legend.text=c("expected","observed"))
setwd('C:\\Users\\13048\\Desktop\\Evolution\\Tasks\\Task_04')
source("http://jonsmitchell.com/code/fxn05.R")
Pop1<-simPop(Popsize=50,nGenerations=100,initial_p=0.5,h=1,s=0)
plot(1:nrow(Pop1),Pop1[,1],ylim=c(0,1),type="l",xlab="generation",ylab="allele freq.",lwd=2)
lines(1:nrow(Pop1),Pop1[,2],lwd=2,col='red')
legend("topleft",legend=c("a","b"),col=c("black","red"),lwd=2,bty="n")
plotFit(nruns=10,n=50,ngens=100,init_p=0.5,h=1,s=0)
Expectation<-c(10,10,10,10)
Observed<-c(15,15,5,5)
Chisq<-sum(((Expectation-Observed)^2)/Expectation)
barplot(rbind(Expectation,Observed),beside=T,main=bquote(chi^2~"="~.(Chisq)),legend.text=c("expected","observed"))
results<-read.csv("http://jonsmitchell.com/data/biol112labresults.csv",stringsAsFactors=F)
counts<-results[,c("yellow","red","green","blue","black","tan")]
backgrounds<-c("White","Red","Yellow","Green","Blue","Black")
backgroundCol<-c("white","#d53e4f","#fee08b","#abdda4","#3288bd","black")
calcChi(counts[1,])
Chisqs<-apply(counts,1,calcChi)
plotChis(counts)
Avg<-mean(Chisqs)
Avg
backgroundAvgs<-tapply(Chisqs,results[,3],mean)
propSig<-length(which(Chisqs>11.70))/length(Chisqs)
percSig<-round(100*propSig)
percSig
par(las=1,mar=c(4,4,1,1),mgp=c(2,0.5,0),tck=-0.01,cex.axis=1)
hist(Chisqs,main="",xlab="chi-squared values",ylab="frequency")
par(las=1,mar=c(4,4,1,1),mgp=c(2,0.5,0),tck=-0.01,cex.axis=1)
plot(1,1,xlim=c(0,400),ylim=c(1,8.5),xlab="",ylab="",type="n",yaxt="n")
axis(2,at=1:length(backgrounds),labels=backgrounds)
mtext(side=1,expression(chi^2),cex=1.75,line=2.5)
counter<-1
for(i in backgrounds) {
Data<-Chisqs[which(results[,3]==i)]
addHist(Y=counter,Dat=Data,Color=backgroundCol[counter])
counter<-counter+1
}
abline(v=11.70,lty=2,lwd=2,col='black')
simulation<-simDraws(10000)
addHist(Y=7,Dat=Simulation,Color="lightgray")
Simulation<-simDraws(10000)
addHist(Y=7,Dat=Simulation,Color="lightgray")
mtext(side=2,at=7,line=0,"simulated")
abline(v=11.70,lty=2,lwd=2)
Fit<-c(1,1,1,1,1,1)
names(Fit)<-1:6
Simulation2<-simDraws(1e4,w=Fit)
addHist(Y=8,Dat=Simulation2,Color=rgb(0,0,0,0.25))
Fit<-c(0.1,1,1,1,1,1)
names(Fit)<-1:6
Simulation3<-simDraws(1e4,w=Fit)
addHist(Y=8,Dat=Simulation3,Color=rgb(0,0,0,0.25))
Fit<-c(0.5,0.6,0.7,1,1,1)
names(Fit)<-1:6
Simulation5<-simDraws(1e4,w=Fit)
addHist(Y=8,Dat=Simulation5,Color=rgb(0,0,0,0.25))
Fit<-c(0.1,0.1,0.1,0.1,0.1,1)
names(Fit)<-1:6
Simulation6<-simDraws(1e4,w=Fit)
addHist(Y=8,Dat=Simulation6,Color=rgb(0,0,0,0.25))
mtext(side=2,at=8,line=0,"sel.sim.")
Simulation7<-c(Simulation2,Simulation3,Simulation4,Simulation5,Simulation6)
Simulation4<-simDraws(1e4,w=Fit)
addHist(Y=8,Dat=Simulation5,Color=rgb(0,0,0,0.25))
Fit<-c(0.1,0.2,0.3,0.4,0.5,1)
namesFit(Fit)<-1:6
names(Fit)<-1:6
Simulation5<-simDraws(1e4,w=Fit)
addHist(Y=8,Dat=Simulation5,Color=rgb(0,0,0,0.25))
Simulation7<-c(Simulation2,Simulation3,Simulation4,Simulation5,Simulation6)
addHist(Y=8,Dat=Simulation7,Color=rgb(0,0,1,0.25))
Simulation<-simDraws(mutate=10000)
